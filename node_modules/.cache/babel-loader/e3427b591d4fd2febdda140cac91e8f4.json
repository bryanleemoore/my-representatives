{"ast":null,"code":"/**!\n * digest-header - index.js\n *\n * Copyright(c) fengmk2 and other contributors.\n * MIT Licensed\n *\n * Authors:\n *   fengmk2 <fengmk2@gmail.com> (http://fengmk2.github.com)\n */\n'use strict';\n/**\n * Module dependencies.\n */\n\nvar crypto = require('crypto');\n\nvar utility = require('utility');\n\nvar AUTH_KEY_VALUE_RE = /(\\w+)=[\"']?([^'\"]+)[\"']?/;\nvar NC = 0;\nvar NC_PAD = '00000000';\n\nfunction digestAuthHeader(method, uri, wwwAuthenticate, userpass) {\n  var parts = wwwAuthenticate.split(',');\n  var opts = {};\n\n  for (var i = 0; i < parts.length; i++) {\n    var m = parts[i].match(AUTH_KEY_VALUE_RE);\n\n    if (m) {\n      opts[m[1]] = m[2].replace(/[\"']/g, '');\n    }\n  }\n\n  if (!opts.realm || !opts.nonce) {\n    return '';\n  }\n\n  var qop = opts.qop || ''; // WWW-Authenticate: Digest realm=\"testrealm@host.com\",\n  //                       qop=\"auth,auth-int\",\n  //                       nonce=\"dcd98b7102dd2f0e8b11d0f600bfb0c093\",\n  //                       opaque=\"5ccc069c403ebaf9f0171e9517f40e41\"\n  // Authorization: Digest username=\"Mufasa\",\n  //                    realm=\"testrealm@host.com\",\n  //                    nonce=\"dcd98b7102dd2f0e8b11d0f600bfb0c093\",\n  //                    uri=\"/dir/index.html\",\n  //                    qop=auth,\n  //                    nc=00000001,\n  //                    cnonce=\"0a4f113b\",\n  //                    response=\"6629fae49393a05397450978507c4ef1\",\n  //                    opaque=\"5ccc069c403ebaf9f0171e9517f40e41\"\n  // HA1 = MD5( \"Mufasa:testrealm@host.com:Circle Of Life\" )\n  //      = 939e7578ed9e3c518a452acee763bce9\n  //\n  //  HA2 = MD5( \"GET:/dir/index.html\" )\n  //      = 39aff3a2bab6126f332b942af96d3366\n  //\n  //  Response = MD5( \"939e7578ed9e3c518a452acee763bce9:\\\n  //                   dcd98b7102dd2f0e8b11d0f600bfb0c093:\\\n  //                   00000001:0a4f113b:auth:\\\n  //                   39aff3a2bab6126f332b942af96d3366\" )\n  //           = 6629fae49393a05397450978507c4ef1\n\n  userpass = userpass.split(':');\n  var nc = String(++NC);\n  nc = NC_PAD.substring(nc.length) + nc;\n  var cnonce = crypto.randomBytes(8).toString('hex');\n  var ha1 = utility.md5(userpass[0] + ':' + opts.realm + ':' + userpass[1]);\n  var ha2 = utility.md5(method.toUpperCase() + ':' + uri);\n  var s = ha1 + ':' + opts.nonce;\n\n  if (qop) {\n    qop = qop.split(',')[0];\n    s += ':' + nc + ':' + cnonce + ':' + qop;\n  }\n\n  s += ':' + ha2;\n  var response = utility.md5(s);\n  var authstring = 'Digest username=\"' + userpass[0] + '\", realm=\"' + opts.realm + '\", nonce=\"' + opts.nonce + '\", uri=\"' + uri + '\", response=\"' + response + '\"';\n\n  if (opts.opaque) {\n    authstring += ', opaque=\"' + opts.opaque + '\"';\n  }\n\n  if (qop) {\n    authstring += ', qop=' + qop + ', nc=' + nc + ', cnonce=\"' + cnonce + '\"';\n  }\n\n  return authstring;\n}\n\nmodule.exports = digestAuthHeader;","map":{"version":3,"names":["crypto","require","utility","AUTH_KEY_VALUE_RE","NC","NC_PAD","digestAuthHeader","method","uri","wwwAuthenticate","userpass","parts","split","opts","i","length","m","match","replace","realm","nonce","qop","nc","String","substring","cnonce","randomBytes","toString","ha1","md5","ha2","toUpperCase","s","response","authstring","opaque","module","exports"],"sources":["C:/Users/bryan/Desktop/myrepresentatives/frontend/node_modules/digest-header/index.js"],"sourcesContent":["/**!\n * digest-header - index.js\n *\n * Copyright(c) fengmk2 and other contributors.\n * MIT Licensed\n *\n * Authors:\n *   fengmk2 <fengmk2@gmail.com> (http://fengmk2.github.com)\n */\n\n'use strict';\n\n/**\n * Module dependencies.\n */\n\nvar crypto = require('crypto');\nvar utility = require('utility');\n\nvar AUTH_KEY_VALUE_RE = /(\\w+)=[\"']?([^'\"]+)[\"']?/;\nvar NC = 0;\nvar NC_PAD = '00000000';\n\nfunction digestAuthHeader(method, uri, wwwAuthenticate, userpass) {\n  var parts = wwwAuthenticate.split(',');\n  var opts = {};\n  for (var i = 0; i < parts.length; i++) {\n    var m = parts[i].match(AUTH_KEY_VALUE_RE);\n    if (m) {\n      opts[m[1]] = m[2].replace(/[\"']/g, '');\n    }\n  }\n\n  if (!opts.realm || !opts.nonce) {\n    return '';\n  }\n\n  var qop = opts.qop || '';\n\n  // WWW-Authenticate: Digest realm=\"testrealm@host.com\",\n  //                       qop=\"auth,auth-int\",\n  //                       nonce=\"dcd98b7102dd2f0e8b11d0f600bfb0c093\",\n  //                       opaque=\"5ccc069c403ebaf9f0171e9517f40e41\"\n  // Authorization: Digest username=\"Mufasa\",\n  //                    realm=\"testrealm@host.com\",\n  //                    nonce=\"dcd98b7102dd2f0e8b11d0f600bfb0c093\",\n  //                    uri=\"/dir/index.html\",\n  //                    qop=auth,\n  //                    nc=00000001,\n  //                    cnonce=\"0a4f113b\",\n  //                    response=\"6629fae49393a05397450978507c4ef1\",\n  //                    opaque=\"5ccc069c403ebaf9f0171e9517f40e41\"\n  // HA1 = MD5( \"Mufasa:testrealm@host.com:Circle Of Life\" )\n  //      = 939e7578ed9e3c518a452acee763bce9\n  //\n  //  HA2 = MD5( \"GET:/dir/index.html\" )\n  //      = 39aff3a2bab6126f332b942af96d3366\n  //\n  //  Response = MD5( \"939e7578ed9e3c518a452acee763bce9:\\\n  //                   dcd98b7102dd2f0e8b11d0f600bfb0c093:\\\n  //                   00000001:0a4f113b:auth:\\\n  //                   39aff3a2bab6126f332b942af96d3366\" )\n  //           = 6629fae49393a05397450978507c4ef1\n  userpass = userpass.split(':');\n\n  var nc = String(++NC);\n  nc = NC_PAD.substring(nc.length) + nc;\n  var cnonce = crypto.randomBytes(8).toString('hex');\n\n  var ha1 = utility.md5(userpass[0] + ':' + opts.realm + ':' + userpass[1]);\n  var ha2 = utility.md5(method.toUpperCase() + ':' + uri);\n  var s = ha1 + ':' + opts.nonce;\n  if (qop) {\n    qop = qop.split(',')[0];\n    s += ':' + nc + ':' + cnonce + ':' + qop;\n  }\n  s += ':' + ha2;\n  var response = utility.md5(s);\n  var authstring = 'Digest username=\"' + userpass[0] + '\", realm=\"' + opts.realm\n    + '\", nonce=\"' + opts.nonce + '\", uri=\"' + uri\n    + '\", response=\"' + response + '\"';\n  if (opts.opaque) {\n    authstring += ', opaque=\"' + opts.opaque + '\"';\n  }\n  if (qop) {\n    authstring +=', qop=' + qop + ', nc=' + nc + ', cnonce=\"' + cnonce + '\"';\n  }\n  return authstring;\n}\n\nmodule.exports = digestAuthHeader;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}