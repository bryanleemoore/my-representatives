{"ast":null,"code":"'use strict';\n\nvar util = require('util');\n\nvar debug = require('debug')('urllib');\n\nvar ms = require('humanize-ms');\n\nvar HttpClient = require('./httpclient');\n\nvar _Promise;\n\nmodule.exports = HttpClient2;\n\nfunction HttpClient2(options) {\n  HttpClient.call(this, options);\n}\n\nutil.inherits(HttpClient2, HttpClient);\n\nHttpClient2.prototype.request = HttpClient2.prototype.curl = function request(url, args) {\n  var self = this;\n  args = args || {};\n  args.retry = args.retry || 0;\n\n  if (args.retryDelay) {\n    args.retryDelay = ms(args.retryDelay);\n  }\n\n  args.isRetry = args.isRetry || function (res) {\n    return res.status >= 500;\n  };\n\n  return HttpClient.prototype.request.call(self, url, args).then(function (res) {\n    if (args.retry > 0 && typeof args.isRetry === 'function' && args.isRetry(res)) {\n      args.retry--;\n      debug('retry request %s, remain %s', url, args.retry);\n\n      if (args.retryDelay) {\n        debug('retry after %sms', args.retryDelay);\n        return sleep(args.retryDelay).then(function () {\n          return self.request(url, args);\n        });\n      }\n\n      return self.request(url, args);\n    }\n\n    return res;\n  }).catch(function (err) {\n    if (args.retry > 0) {\n      args.retry--;\n      debug('retry request %s, remain %s, err %s', url, args.retry, err);\n\n      if (args.retryDelay) {\n        debug('retry after %sms', args.retryDelay);\n        return sleep(args.retryDelay).then(function () {\n          return self.request(url, args);\n        });\n      }\n\n      return self.request(url, args);\n    }\n\n    throw err;\n  });\n};\n\nHttpClient2.prototype.requestThunk = function requestThunk(url, args) {\n  var self = this;\n  return function (callback) {\n    self.request(url, args).then(function (res) {\n      var cb = callback; // make sure cb(null, res) throw error won't emit catch callback below\n\n      callback = null;\n      cb(null, res);\n    }).catch(function (err) {\n      if (!callback) {\n        // TODO: how to handle this error?\n        return;\n      }\n\n      callback(err);\n    });\n  };\n};\n\nfunction sleep(ms) {\n  if (!_Promise) {\n    _Promise = require('any-promise');\n  }\n\n  return new _Promise(function (resolve) {\n    setTimeout(resolve, ms);\n  });\n}","map":{"version":3,"names":["util","require","debug","ms","HttpClient","_Promise","module","exports","HttpClient2","options","call","inherits","prototype","request","curl","url","args","self","retry","retryDelay","isRetry","res","status","then","sleep","catch","err","requestThunk","callback","cb","resolve","setTimeout"],"sources":["C:/Users/bryan/Desktop/myrepresentatives/frontend/node_modules/urllib/lib/httpclient2.js"],"sourcesContent":["'use strict';\n\nvar util = require('util');\nvar debug = require('debug')('urllib');\nvar ms = require('humanize-ms');\nvar HttpClient = require('./httpclient');\n\nvar _Promise;\n\nmodule.exports = HttpClient2;\n\nfunction HttpClient2(options) {\n  HttpClient.call(this, options);\n}\n\nutil.inherits(HttpClient2, HttpClient);\n\nHttpClient2.prototype.request = HttpClient2.prototype.curl = function request(url, args) {\n  var self = this;\n  args = args || {};\n  args.retry = args.retry || 0;\n  if (args.retryDelay) {\n    args.retryDelay = ms(args.retryDelay);\n  }\n  args.isRetry = args.isRetry || function(res) {\n    return res.status >= 500;\n  };\n  return HttpClient.prototype.request.call(self, url, args)\n  .then(function(res) {\n    if (args.retry > 0 && typeof args.isRetry === 'function' && args.isRetry(res)) {\n      args.retry--;\n      debug('retry request %s, remain %s', url, args.retry);\n      if (args.retryDelay) {\n        debug('retry after %sms', args.retryDelay);\n        return sleep(args.retryDelay).then(function() { return self.request(url, args); });\n      }\n      return self.request(url, args);\n    }\n    return res;\n  })\n  .catch(function(err) {\n    if (args.retry > 0) {\n      args.retry--;\n      debug('retry request %s, remain %s, err %s', url, args.retry, err);\n      if (args.retryDelay) {\n        debug('retry after %sms', args.retryDelay);\n        return sleep(args.retryDelay).then(function() { return self.request(url, args); });\n      }\n      return self.request(url, args);\n    }\n    throw err;\n  });\n};\n\nHttpClient2.prototype.requestThunk = function requestThunk(url, args) {\n  var self = this;\n  return function(callback) {\n    self.request(url, args)\n    .then(function(res) {\n      var cb = callback;\n      // make sure cb(null, res) throw error won't emit catch callback below\n      callback = null;\n      cb(null, res);\n    })\n    .catch(function(err) {\n      if (!callback) {\n        // TODO: how to handle this error?\n        return;\n      }\n      callback(err);\n    });\n  };\n};\n\nfunction sleep(ms) {\n  if (!_Promise) {\n    _Promise = require('any-promise');\n  }\n\n  return new _Promise(function(resolve) {\n    setTimeout(resolve, ms);\n  });\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}